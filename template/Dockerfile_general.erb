
FROM <%= @image %>
LABEL version="0.1"
LABEL maintainer="<%= @maintainer %>"
LABEL description="Dockerfile generated by dockerun" 
LABEL dockerun-info="https://github.com/chrisliaw/dockerun"

<% case @image_base.to_sym
when :fedora %>
RUN dnf update && dnf install sudo git curl 
<% else %>
RUN apt-get update && apt-get install -y sudo git curl build-essential
<% end %>

<% if TR::RTUtils.on_linux? %>

RUN groupadd -f -g <%= @user_group_id %>  <%= @user_group_name %> && \ 
    useradd -u <%= @user_id %> -g <%= @user_group_id %> -m <%= @user_login %> && \
    usermod -aG sudo <%= @user_login %> && \ 
    echo '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers

USER <%= @user_login %>

# from this point onwards, sudo is required for privileaged operation
#RUN sudo apt-get install -y curl build-essential

<% end %>

# other Dockerfile entries starts here

CMD [ "/bin/bash", "--login" ]

